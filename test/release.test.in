#!/bin/bash

# https://stackoverflow.com/questions/1378274/in-a-bash-script-how-can-i-exit-the-entire-script-if-a-certain-condition-occurs
yell() { echo "$0: $*" >&2; }
die() { yell "$*"; exit 1; }
try() { "$@" || die "cannot $*"; }

# get path to the project dep directory
depdir="@CMAKE_SOURCE_DIR@/dep"

# get path to release source directory
srcdir="@CMAKE_CURRENT_SOURCE_DIR@/release"

# get path to release bin directory
bindir="@CMAKE_SOURCE_DIR@/src"

# check that required files exist with correct permissions
try test -r $srcdir/tests
try test -x $depdir/shunit2/shunit2

# HACK: req'd since shunit2 does not appear to find dynamically created
# functions.
suite() {
  # load test functions
  . $srcdir/tests
}

# initiate the test runner
. $depdir/shunit2/shunit2
